// ==UserScript==
// @name         Darkify
// @version      0.4.8
// @description  Darken Any Website
// @run-at       document-end
// @author       erichsia7
// @inject-into  content
// @updateURL    https://erichsia7.github.io/darkify-extension/darkify-extension.user.js
// @downloadURL  https://erichsia7.github.io/darkify-extension/darkify-extension.user.js
// @match        *://*/*
// @noframes     
// @exclude      *://*.google.com/*
// @exclude      *://*.youtube.com/*
// @exclude      *://github.*/*
// ==/UserScript==
var darkify;(()=>{"use strict";var t={d:(r,e)=>{for(var n in e)t.o(e,n)&&!t.o(r,n)&&Object.defineProperty(r,n,{enumerable:!0,get:e[n]})},o:(t,r)=>Object.prototype.hasOwnProperty.call(t,r)},r={};(()=>{function e(t){for(var r="",e="abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ",n=0;n<10;n++){var o=Math.round(62*Math.random());r+=e.substring(o,o+1)}return r=t+r}function n(t,r){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=function(t,r){if(t){if("string"==typeof t)return o(t,r);var e={}.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?o(t,r):void 0}}(t))||r&&t&&"number"==typeof t.length){e&&(t=e);var n=0,a=function(){};return{s:a,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,c=!0,s=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return c=t.done,t},e:function(t){s=!0,i=t},f:function(){try{c||null==e.return||e.return()}finally{if(s)throw i}}}}function o(t,r){(null==r||r>t.length)&&(r=t.length);for(var e=0,n=Array(r);e<r;e++)n[e]=t[e];return n}function a(t){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a(t)}t.d(r,{default:()=>_});var i=255,c=255,s=255,l=0;function d(t){return"object"!==a(t)||Array.isArray(t)?{type:"color",r:i,g:c,b:s}:{type:"color",r:t.hasOwnProperty("r")?t.r:i,g:t.hasOwnProperty("g")?t.g:c,b:t.hasOwnProperty("b")?t.b:s}}function u(t){return"object"!==a(t)||Array.isArray(t)?{type:"color",r:i,g:c,b:s,a:l}:{type:"color",r:t.hasOwnProperty("r")?t.r:i,g:t.hasOwnProperty("g")?t.g:c,b:t.hasOwnProperty("b")?t.b:s,a:t.hasOwnProperty("a")?t.a:l}}function f(t){var r,e,n=d(t),o=n.r/255,a=n.g/255,i=n.b/255,c=Math.max(o,a,i),s=Math.min(o,a,i),l=(c+s)/2;if(c===s)r=e=0;else{var u=c-s;switch(e=l>.5?u/(2-c-s):u/(c+s),c){case o:r=(a-i)/u+(a<i?6:0);break;case a:r=(i-o)/u+2;break;case i:r=(o-a)/u+4}r/=6}return{type:"color",h:r,s:e,l}}function m(t){var r=!1,e=f(t);if((e.s<=.38||e.l<=.23)&&(r=!0),r){var n=u(t),o=f({type:"color",r:255-n.r,g:255-n.g,b:255-n.b}),a=function(t){var r=t.h,e=t.s,n=t.l;if(0===e){var o=Math.round(255*n);return{type:"color",r:o,g:o,b:o}}var a=function(t,r,e){return e<0&&(e+=1),e>1&&(e-=1),e<1/6?t+6*(r-t)*e:e<1/3?r:e<.5?t+(r-t)*(2/3-e)*6:t},i=n<.5?n*(1+e):n+e-n*e,c=2*n-i,s=a(c,i,r+1/3),l=a(c,i,r),d=a(c,i,r-1/3);return{type:"color",r:Math.round(255*s),g:Math.round(255*l),b:Math.round(255*d)}}({type:"color",h:e.h,s:o.s,l:o.l});return{type:"color",r:a.r,g:a.g,b:a.b,a:n.a}}return t}function p(t,r){var e=getComputedStyle(t);function n(t){if(t.startsWith("var(")){var r=t.slice(4,-1).trim(),o=e.getPropertyValue(r).trim();return o.startsWith("var(")?n(o):o}return t}function o(t){var r=t.match(/rgba?\((\d+),\s{0,}(\d+),\s{0,}(\d+)(?:,\s{0,}(\d+\.?\d*))?\)/);if(!r)throw new Error("Invalid RGB/RGBA format: ".concat(t));return{type:"color",r:parseInt(r[1]),g:parseInt(r[2]),b:parseInt(r[3]),a:r[4]?parseFloat(r[4]):1}}function a(t){return"transparent"===(t=n(t))?{type:"color",r:0,g:0,b:0,a:0}:t.startsWith("rgb")?o(t):t.startsWith("#")?function(t){var r,e,n;if(4===t.length)r=parseInt(t[1]+t[1],16),e=parseInt(t[2]+t[2],16),n=parseInt(t[3]+t[3],16);else{if(7!==t.length)throw new Error("Invalid hex format");r=parseInt(t.slice(1,3),16),e=parseInt(t.slice(3,5),16),n=parseInt(t.slice(5,7),16)}return{type:"color",r,g:e,b:n,a:1}}(t):t.startsWith("linear-gradient")||t.startsWith("radial-gradient")||t.startsWith("conic-gradient")?function(t){var r;function e(t){var r=/(\d+(cm|mm|in|px|pt|px|em|ex|ch|rem|vw|vh|vmin|vmax|%))$/,e=[];return t.forEach((function(t){var n=t.trim().match(r);if(n){var o=a(t.trim().replace(r,"").trim()),i=n[0].trim();e.push({type:"color-stop",color:o,position:i})}})),e}if(r=t.match(/^linear-gradient\((.*)\)$/))return function(t){var r=t.match(/linear-gradient\((.*)\)/);if(!r||r.length<2)throw new Error("Invalid linear gradient string");var n=r[1].split(/,(?![^\(]*\))/);return{type:"linear-gradient",direction:n[0].trim().match(/^\d+deg$|^to /)?n.shift().trim():"to bottom",colorStops:e(n)}}(t);if(r=t.match(/^radial-gradient\((.*)\)$/))return function(t){var r={type:"radial-gradient",shape:"circle",size:"farthest-corner",position:"center",colorStops:[]},e=t.match(/radial-gradient\((.*)\)/i);if(!e)throw new Error("Invalid radial gradient string");var n=e[1].split(/,(?![^\(]*\))/),o=0,a=n[o].match(/^\s*(circle|ellipse|closest-side|farthest-side|closest-corner|farthest-corner|contain|cover)?\s*(circle|ellipse|closest-side|farthest-side|closest-corner|farthest-corner|contain|cover)?\s*/i);a&&(r.shape=a[1]||null,r.size=a[2]||null,(a[1]||a[2])&&o++);var i=n[o].match(/^\s*at\s+([^\s,]+)\s+([^\s,]+)\s*/i);i&&(r.position="".concat(i[1]," ").concat(i[2]),o++);for(var c=o;c<n.length;c++){var s=n[c].trim();r.colorStops.push(s)}return r}(t);if(r=t.match(/^conic-gradient\((.*)\)$/))return function(t){var r=t[1].split(/,(.+)/);return{type:"conic-gradient",angle:r[0].trim(),colorStops:e(r[1])}}(r);throw new Error("Unsupported gradient format")}(t):t.startsWith("url")?{type:"color",r:i,g:c,b:s,a:l}:(r=t,(e=document.createElement("canvas").getContext("2d")).fillStyle=r,o(e.fillStyle));var r,e}return a(e.getPropertyValue(r).trim())}function y(t){for(var r={},e=0,n=["color","background-color","background-image","border-top-color","border-bottom-color","border-right-color","border-left-color","outline-color","text-decoration-color"];e<n.length;e++){var o=n[e];try{r[o]=p(t,o)}catch(t){continue}}return r}function v(t){var r={};for(var e in t){var n,o=t[e];switch(null===(n=o)||void 0===n?void 0:n.type){case"color":r[e]=m(o);break;case"linear-gradient":r[e]={type:"linear-gradient",direction:o.direction,colorStops:o.colorStops.map((function(t){return{type:"color-stop",color:m(t.color),position:t.position}}))};break;case"radial-gradient":r[e]={type:"radial-gradient",shapeAndSize:o.shapeAndSize,colorStops:o.colorStops.map((function(t){return{type:"color-stop",color:m(t.color),position:t.position}}))};break;case"conic-gradient":r[e]={type:"conic-gradient",angle:o.angle,colorStops:o.colorStops.map((function(t){return{type:"color-stop",color:m(t.color),position:t.position}}))};break;default:r[e]=o}}return r}function g(t,r){var e=[];for(var n in r){var o,a=r[n],i="";switch(null===(o=a)||void 0===o?void 0:o.type){case"color":i="rgba(".concat(a.r,", ").concat(a.g,", ").concat(a.b,", ").concat(a.a,")");break;case"linear-gradient":if(!(a.colorStops.length>=2))continue;var c=a.colorStops.map((function(t){return"rgba(".concat(t.color.r,", ").concat(t.color.g,", ").concat(t.color.b,", ").concat(t.color.a,") ").concat(t.position)})).join(", ");i="linear-gradient(".concat(a.direction,", ").concat(c,")");break;case"radial-gradient":if(!(a.colorStops.length>=2))continue;c=a.colorStops.map((function(t){return"rgba(".concat(t.color.r,", ").concat(t.color.g,", ").concat(t.color.b,", ").concat(t.color.a,") ").concat(t.position)})).join(", ");i="radial-gradient(".concat(a.shape," ").concat(a.size," at ").concat(a.position,", ").concat(c,")");break;default:continue}e.push("".concat(n,": ").concat(i," !important"))}return"".concat(t," {").concat(e.join(";"),"}")}function h(){var t,r;t="https://erichsia7.github.io/darkify-extension/darkify-extension.user.min.css",(r=document.createElement("link")).rel="stylesheet",r.type="text/css",r.href=t,document.head.appendChild(r);var e=document.createElement("style");e.classList.add("dark_mode_style_loader"),document.documentElement.appendChild(e)}function b(){var t=document.createElement("div");t.classList.add("darkify_button"),t.setAttribute("dark-mode","false"),t.setAttribute("darkifying","false"),t.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" mode="light"><path d="M480-360q50 0 85-35t35-85q0-50-35-85t-85-35q-50 0-85 35t-35 85q0 50 35 85t85 35Zm0 60q-74.92 0-127.46-52.54Q300-405.08 300-480q0-74.92 52.54-127.46Q405.08-660 480-660q74.92 0 127.46 52.54Q660-554.92 660-480q0 74.92-52.54 127.46Q554.92-300 480-300ZM80-450q-12.75 0-21.37-8.63Q50-467.26 50-480.01q0-12.76 8.63-21.37Q67.25-510 80-510h90q12.75 0 21.38 8.63 8.62 8.63 8.62 21.38 0 12.76-8.62 21.37Q182.75-450 170-450H80Zm710 0q-12.75 0-21.38-8.63-8.62-8.63-8.62-21.38 0-12.76 8.62-21.37Q777.25-510 790-510h90q12.75 0 21.37 8.63 8.63 8.63 8.63 21.38 0 12.76-8.63 21.37Q892.75-450 880-450h-90ZM479.99-760q-12.76 0-21.37-8.62Q450-777.25 450-790v-90q0-12.75 8.63-21.37 8.63-8.63 21.38-8.63 12.76 0 21.37 8.63Q510-892.75 510-880v90q0 12.75-8.63 21.38-8.63 8.62-21.38 8.62Zm0 710q-12.76 0-21.37-8.63Q450-67.25 450-80v-90q0-12.75 8.63-21.38 8.63-8.62 21.38-8.62 12.76 0 21.37 8.62Q510-182.75 510-170v90q0 12.75-8.63 21.37Q492.74-50 479.99-50ZM240.23-678.38l-50.31-48.93q-8.92-8.31-8.61-20.88.31-12.58 8.73-21.89 9.19-9.3 21.58-9.3 12.38 0 21.07 9.3L282-720.15q8.69 9.3 8.69 21.07t-8.5 21.08q-8.5 9.31-20.57 8.81-12.08-.5-21.39-9.19Zm487.08 488.46L678-239.85q-8.69-9.3-8.69-21.38 0-12.08 8.69-20.77 8.12-9.31 20.29-8.81t21.48 9.19l50.31 48.93q8.92 8.31 8.61 20.88-.31 12.58-8.73 21.89-9.19 9.3-21.58 9.3-12.38 0-21.07-9.3ZM678-677.81q-9.31-8.5-8.81-20.57.5-12.08 9.19-21.39l48.93-50.31q8.31-8.92 20.88-8.61 12.58.31 21.89 8.73 9.3 9.19 9.3 21.58 0 12.38-9.3 21.07L720.15-678q-9.3 8.69-21.07 8.69t-21.08-8.5ZM189.92-189.84q-9.3-9.39-9.3-21.78 0-12.38 9.3-21.07L239.85-282q9.3-8.69 21.38-8.69 12.08 0 20.77 8.69 8.92 8.12 8.42 20.29t-8.8 21.48l-48.93 50.31q-8.69 9.3-21.07 9-12.39-.31-21.7-8.92ZM480-480Z"/></svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" mode="dark"><path d="M481.15-140Q339-140 240.08-238.92 141.16-337.85 141.16-480q0-118.38 73.26-210.46 73.27-92.08 195.19-118.69 12.62-3.16 22.23.61 9.62 3.77 15.62 11.23 6 7.47 7.08 18.12 1.07 10.65-5 21.27-12.39 22.54-18.39 46.83t-6 51.09q0 98.33 68.84 167.17Q562.82-424 661.15-424q29.47 0 56.31-7.46 26.85-7.46 47-17.31 9.85-4.3 19.23-3.04 9.39 1.27 16.02 6.27 7.37 5 10.94 13.66 3.58 8.65.81 20.34-21.31 118-114.81 194.77Q603.15-140 481.15-140Zm0-60q88 0 158-48.5t102-126.5q-20 5-40 8t-40 3q-123 0-209.5-86.5T365.15-660q0-20 3-40t8-40q-78 32-126.5 102t-48.5 158q0 116 82 198t198 82Zm-10-270Z"/></svg> ',t.addEventListener("click",(function(t){t.preventDefault(),function(){var t=document.querySelector(".darkify_button"),r=t.getAttribute("dark-mode"),o=t.getAttribute("darkifying");"false"===o&&("false"===r?(t.setAttribute("dark-mode","true"),function(){var t=e("d_"),r=document.querySelector(".darkify_button");r.setAttribute("darkifying","true");var o=document.createElement("style");o.id="".concat(t,"_keyframes"),o.innerHTML=k(),document.documentElement.appendChild(o);var a=function(){var t,r=[],o=n(document.querySelectorAll("body *,body"));try{for(o.s();!(t=o.n()).done;){var a=t.value,i=e("");a.setAttribute("darkify-extension",i);var c=v(y(a));r.push(g("".concat(String(a.tagName).toLowerCase(),'[darkify-extension="').concat(i,'"]'),c))}}catch(t){o.e(t)}finally{o.f()}return r.join("")}(),i=document.querySelector(".darkify_ending_mask"),c=document.querySelector(".darkify_transition_mask");c.classList.add("darkify_transitioning"),c.addEventListener("animationend",(function(e){var n=document.querySelector("style#".concat(t,"_keyframes"));null!==n&&n.remove(),c.classList.remove("darkify_transitioning"),i.classList.add("darkify_displayed"),document.querySelector("style.dark_mode_style_loader").innerHTML=a,setTimeout((function(){i.classList.add("darkify_filter_fade_out")}),1),i.addEventListener("animationend",(function(t){i.classList.remove("darkify_displayed"),i.classList.remove("darkify_filter_fade_out"),r.setAttribute("darkifying","false")}),{once:!0})}),{once:!0})}()):"true"===r&&(t.setAttribute("dark-mode","false"),function(){var t=e("d_"),r=document.querySelector(".darkify_button");r.setAttribute("darkifying","true");var n=document.createElement("style");n.id="".concat(t,"_keyframes"),n.innerHTML=k(),document.documentElement.appendChild(n);var o=document.querySelector(".darkify_ending_mask"),a=document.querySelector(".darkify_transition_mask");a.classList.add("darkify_transitioning"),a.addEventListener("animationend",(function(e){var n=document.querySelector("style#".concat(t,"_keyframes"));null!==n&&n.remove(),a.classList.remove("darkify_transitioning"),o.classList.add("darkify_displayed"),document.querySelector("style.dark_mode_style_loader").innerHTML="",setTimeout((function(){o.classList.add("darkify_filter_fade_out")}),1),o.addEventListener("animationend",(function(t){o.classList.remove("darkify_displayed"),o.classList.remove("darkify_filter_fade_out"),r.setAttribute("darkifying","false")}),{once:!0})}),{once:!0})}()))}()})),document.documentElement.appendChild(t)}function k(){var t=window.innerWidth,r=21.5,e=window.innerHeight-33.5,n=t+100,o=Math.sqrt(Math.pow(n-33.5,2)+Math.pow(-100-e,2))/r;return"@keyframes transitioning-zoom { 0% {transform: scale(1);} 100% {transform: scale(".concat(o,");}}")}var q={initialize:function(){h(),b(),function(){var t=document.createElement("div");t.classList.add("darkify_transition_mask"),document.documentElement.appendChild(t);var r=document.createElement("div");r.classList.add("darkify_ending_mask"),document.documentElement.appendChild(r)}()}};q.initialize();const _=q})(),darkify=r.default})();